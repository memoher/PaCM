<ion-view title="Nuevo mantenimiento" cache-view="false">
    <ion-tabs class="tabs-positive tabs-icon-top">
        <ion-tab title="Inicio" icon="ion-search" hidden="{{ !(tabs.starterTab)}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Código único</span>
                            <input placeholder="" type="text" readonly="readonly" ng-model="maintenance.uniqueCode">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Fecha</span>
                            <input placeholder="" type="date" readonly="readonly" ng-model="maintenance.date">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Cliente</span>
                            <input placeholder="" type="text" readonly="readonly" ng-model="maintenance.customerName" ng-click="searchCustomer()">
                        </label>
                        <button class="button button-small" ng-click="searchCustomer()">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Realizado por</span>
                            <input placeholder="" type="text" readonly="readonly" ng-model="maintenance.executedByUsername">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Estado</span>
                            <input placeholder="" type="text" readonly="readonly" ng-model="maintenance.statusDescription">
                        </label>
                    </div>
                    <ion-toggle toggle-class="toggle-positive" ng-model="maintenance.preventive" ng-change="maintenance.preventive = true">Preventivo</ion-toggle>
                    <ion-toggle toggle-class="toggle-positive" ng-model="maintenance.corrective">Correctivo</ion-toggle>
                </form>
                <div class="button-bar" ng-show="(newMaintenance && maintenance.customerId)">
                    <button class="button button-block  icon ion-battery-charging" ng-click="newBatteryMaintenance()"> Mantenimiento de batería</button>
                    <button class="button button-block  icon ion-flash" ng-click="newChargerMaintenance()"> Mantenimiento de cargador</button>
                </div>
            </ion-content>
        </ion-tab>
        <ion-tab title="Batería" icon="ion-battery-charging" hidden="{{ !(tabs.batteryTab)}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Marca</span>
                            <input placeholder="" type="text" readonly="readonly" ng-model="battery.trademarkName" ng-click="searchObjectTypeTrademark(true)">
                        </label>
                        <button class="button button-small" ng-click="searchObjectTypeTrademark(true)">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Modelo</span>
                            <input placeholder="" type="text" readonly="readonly" ng-model="battery.modelName" ng-click="searchObjectTypeModel(true)">
                        </label>
                        <button class="button button-small" ng-click="searchObjectTypeModel(true)">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Serial</span>
                            <input type="text" placeholder="" ng-model="battery.serial" ng-readonly="(maintenance.batteryId)">
                        </label>
                        <button class="button button-small" ng-click="searchObjectType(true)">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Nro Interno</span>
                            <input placeholder="" type="text" ng-model="battery.customerReference">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Voltaje</span>
                            <select ng-options="bt.id as bt.description for bt in resources.batteryTypes" ng-model="battery.typeId" ng-disabled="(maintenance.batteryId)" ng-change="getMaintenanceInfo()">
                            </select>
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Amperaje</span>
                            <input placeholder="" type="text" ng-model="battery.amperage" ng-readonly="(maintenance.batteryId)">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Conector</span>
                            <select style="width:33%;" ng-options="ct.id as ct.name for ct in resources.connectorTypes" ng-model="battery.connectorTypeId" ng-disabled="(maintenance.batteryId)">
                            </select>
                            <select style="width:33%;" ng-options="c.id as c.name for c in resources.connectors | filter: { typeId: battery.connectorTypeId }" ng-model="battery.connectorId" ng-disabled="(maintenance.batteryId)">
                            </select>
                            <select style="width:33%;" ng-options="cc.id as cc.name for cc in resources.connectorColors" ng-model="battery.connectorColorId" ng-disabled="(maintenance.batteryId)" ng-show="showConnectorColorList()">
                            </select>
                        </label>
                    </div>
                    <ion-toggle toggle-class="toggle-positive" ng-model="battery.standardBox" ng-change="battery.standardBox = (maintenance.batteryId) ? !battery.standardBox : battery.standardBox">Caja estandar</ion-toggle>
                    <ion-toggle toggle-class="toggle-positive" ng-model="battery.cover" ng-change="battery.cover = (maintenance.batteryId) ? !battery.cover : battery.cover">Tapa</ion-toggle>
                    <ion-toggle toggle-class="toggle-positive" ng-model="battery.drainHoles" ng-change="battery.drainHoles = (maintenance.batteryId) ? !battery.drainHoles : battery.drainHoles">Agujeros de drenaje</ion-toggle>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Peso mínimo (kg)</span>
                            <input placeholder="" type="number" ng-model="battery.minimunWeight" ng-readonly="(maintenance.batteryId)">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Peso máximo (kg)</span>
                            <input placeholder="" type="number" ng-model="battery.maximunWeight" ng-readonly="(maintenance.batteryId)">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Longitud (mm)</span>
                            <input placeholder="" type="number" ng-model="battery.length" ng-readonly="(maintenance.batteryId)">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Ancho (mm)</span>
                            <input placeholder="" type="number" ng-model="battery.width" ng-readonly="(maintenance.batteryId)">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Altura de los ojales (mm)</span>
                            <input placeholder="" type="number" ng-model="battery.handleHeight" ng-readonly="(maintenance.batteryId)">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Altura de la jarra (mm)</span>
                            <input placeholder="" type="number" ng-model="battery.boxHeight" ng-readonly="(maintenance.batteryId)">
                        </label>
                    </div>

                </form>
            </ion-content>
        </ion-tab>
        <ion-tab title="Cargador" icon="ion-flash" hidden="{{ !(tabs.chargerTab)}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Marca</span>
                            <input placeholder="" type="text" readonly="readonly" ng-model="charger.trademarkName" ng-click="searchObjectTypeTrademark(false)">
                        </label>
                        <button class="button button-small" ng-click="searchObjectTypeTrademark(false)">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Modelo</span>
                            <input placeholder="" type="text" readonly="readonly" ng-model="charger.modelName" ng-click="searchObjectTypeModel(false)">
                        </label>
                        <button class="button button-small" ng-click="searchObjectTypeModel(false)">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Serial</span>
                            <input type="text" placeholder="" ng-model="charger.serial" ng-readonly="(maintenance.chargerId)">
                        </label>
                        <button class="button button-small" ng-click="searchObjectType(false)">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Nro Interno</span>
                            <input placeholder="" type="text" ng-model="charger.customerReference">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Voltaje</span>
                            <input placeholder="" type="text" ng-model="charger.voltage" ng-readonly="(maintenance.chargerId)" ng-change="getMaintenanceInfo()">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Amperaje</span>
                            <input placeholder="" type="text" ng-model="charger.amperage" ng-readonly="(maintenance.chargerId)">
                        </label>
                    </div>
                </form>
            </ion-content>
        </ion-tab>
        <ion-tab title="Máquina" icon="ion-gear-a" hidden="{{ !(tabs.machineTab())}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Marca</span>
                            <input placeholder="" type="text" ng-model="machine.trademarkName" ng-readonly="(maintenance.machineId)">
                        </label>
                        <button class="button button-small" ng-click="searchMachineTrademark(false)">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Modelo</span>
                            <input placeholder="" type="text" ng-model="machine.modelName" ng-readonly="(maintenance.machineId)">
                        </label>
                        <button class="button button-small" ng-click="searchMachineModel(false)">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Serial</span>
                            <input type="text" placeholder="" ng-model="machine.serial" ng-readonly="(maintenance.machineId)">
                        </label>
                        <button class="button button-small" ng-click="searchMachine(false)">
                            <i class="icon ion-search"></i>
                        </button>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Nro Interno</span>
                            <input placeholder="" type="text" ng-model="machine.customerReference">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Longitud compartimiento (mm)</span>
                            <input placeholder="" type="number" ng-model="machine.compartmentLength" ng-readonly="(machine.modelId)">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Ancho compartimiento (mm)</span>
                            <input placeholder="" type="number" ng-model="machine.compartmentWidth" ng-readonly="(machine.modelId)">
                        </label>
                    </div>
                    <div class="item item-input-inset">
                        <label class="item-input-wrapper">
                            <span class="input-label">Altura compartimiento (mm)</span>
                            <input placeholder="" type="number" ng-model="machine.compartmentHeight" ng-readonly="(machine.modelId)">
                        </label>
                    </div>
                </form>
            </ion-content>
        </ion-tab>
        <ion-tab title="Trabajo a realizar" icon="ion-hammer" hidden="{{ !(tabs.workToBeDoneTab())}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <textarea rows="20" ng-model="maintenance.workToBeDone"></textarea>
                </form>
            </ion-content>
        </ion-tab>
        <ion-tab title="Inspección física" icon="ion-clipboard" hidden="{{ !(tabs.physicalInspectionTab())}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <div ng-repeat="cl in checkList| orderBy: 'checkOrder'">
                        <div class="item item-input-inset">
                            <label class="item-input-wrapper">
                                <span class="input-label">{{ cl.checkName}}</span>
                                <select ng-options="d.id as d.name for d in resources.diagnostics | filter: { typeId: cl.diagnosticTypeId }" ng-model="cl.diagnosticId">
                                </select>
                            </label>
                        </div>
                        <div class="item item-input-inset">
                            <label class="item-input-wrapper">
                                <input placeholder="" type="text" ng-model="cl.comments">
                            </label>
                        </div>
                    </div>
                </form>
            </ion-content>
        </ion-tab>
        <ion-tab title="Inspección de celdas" icon="ion-battery-empty" hidden="{{ !(tabs.cellInspectionTab())}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <div class="row" ng-repeat="cr in reviewOfCells| orderBy: 'cellOrder'">
                        <div class="col col-10">
                            # {{ cr.cellOrder}}
                        </div>
                        <div class="col col-10">
                            <div class="item item-input-inset">
                                <label class="item-input-wrapper">
                                    <input type="number" placeholder="Voltaje" ng-model="cr.voltage">
                                </label>
                            </div>
                        </div>
                        <div class="col col-10">
                            <div class="item item-input-inset">
                                <label class="item-input-wrapper">
                                    <input type="number" placeholder="Densidad" ng-model="cr.density">
                                </label>
                            </div>
                        </div>
                        <div class="col">
                            <div class="item item-input-inset">
                                <label class="item-input-wrapper">
                                    <input type="text" placeholder="Comentarios" ng-model="cr.comments">
                                </label>
                            </div>
                        </div>
                    </div>
                </form>
            </ion-content>
        </ion-tab>
        <ion-tab title="Insumos" icon="ion-medkit" hidden="{{ !(tabs.suppliesTab())}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <ion-list>
                    </ion-list>
                </form>
            </ion-content>
        </ion-tab>
        <ion-tab title="Reporte técnico" icon="ion-compose" hidden="{{ !(tabs.technicalReportTab())}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <textarea rows="20" ng-model="maintenance.technicalReport"></textarea>
                </form>
            </ion-content>
        </ion-tab>
        <ion-tab title="Finalizar" icon="ion-checkmark" hidden="{{ !(tabs.endingTab())}}">
            <ion-content padding="true" class="has-header">
                <form>
                    <button class="button" ng-click="saveMaintenance()">
                        <i class="icon ion-checkmark"></i>
                        Guardar todos los cambios realizados
                    </button>
                </form>
            </ion-content>
        </ion-tab>
    </ion-tabs>
</ion-view>

